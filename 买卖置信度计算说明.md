# 买卖置信度计算说明

## 🎯 置信度概述

买卖置信度是一个0-100%的数值，表示技术分析信号的可靠程度。置信度越高，表示信号越可靠；置信度越低，表示信号越不确定。

## 📊 置信度计算方法

### 1. 短线分组（15分钟MA34和MA55）

#### 买入信号置信度计算
```javascript
// 基础置信度：70%
// 均线差距因子：maGap * 2
// 价格位置因子：priceAboveMA * 0.5
confidence = 70 + maGap * 2 + priceAboveMA * 0.5
```

**计算因子：**
- **均线差距**：`|MA34 - MA55| / MA55 * 100`
  - 差距越大，信号越强
  - 例如：MA34=10.5, MA55=10.0，差距=5%
- **价格位置**：`(当前价格 - MA34) / MA34 * 100`
  - 价格在MA34上方越多，买入信号越强
  - 例如：价格=10.8, MA34=10.5，位置=2.86%

**置信度范围：60%-95%**

#### 卖出信号置信度计算
```javascript
// 基础置信度：65%
// 均线差距因子：maGap * 2
// 价格位置因子：priceBelowMA * 0.5
confidence = 65 + maGap * 2 + priceBelowMA * 0.5
```

### 2. 中线分组（日线MA8和MA20）

#### 买入信号置信度计算
```javascript
// 基础置信度：75%
// 均线差距因子：maGap * 1.5
// 趋势强度因子：trendStrength * 10
// 价格位置因子：priceAboveMA * 0.3
confidence = 75 + maGap * 1.5 + trendStrength * 10 + priceAboveMA * 0.3
```

**计算因子：**
- **均线差距**：`|MA8 - MA20| / MA20 * 100`
- **趋势强度**：基于20日价格变化和波动性计算
- **价格位置**：`(当前价格 - MA8) / MA8 * 100`

**置信度范围：65%-95%**

#### 卖出信号置信度计算
```javascript
// 基础置信度：70%
// 均线差距因子：maGap * 1.5
// 趋势强度因子：trendStrength * 10
// 价格位置因子：priceBelowMA * 0.3
confidence = 70 + maGap * 1.5 + trendStrength * 10 + priceBelowMA * 0.3
```

## 🔍 趋势强度计算

### 计算公式
```javascript
// 1. 计算价格变化百分比
priceChange = (最新价格 - 20日前价格) / 20日前价格 * 100

// 2. 计算价格波动性
avgPrice = 20日平均价格
variance = 20日价格方差
volatility = sqrt(variance) / avgPrice * 100

// 3. 计算趋势强度
trendStrength = |priceChange| / (volatility + 1)

// 4. 归一化到0-1
trendStrength = min(1, max(0, trendStrength / 10))
```

### 趋势强度含义
- **0.8-1.0**：强趋势，价格变化明显且稳定
- **0.5-0.8**：中等趋势，有一定方向性
- **0.2-0.5**：弱趋势，方向不明确
- **0.0-0.2**：无趋势，横盘整理

## 📈 置信度等级说明

### 高置信度（85%-95%）
- **特征**：均线差距大，趋势明确，价格位置理想
- **建议**：可以重点关注，信号可靠性高
- **示例**：MA8=12.0, MA20=10.0，差距20%，趋势强度0.8

### 中置信度（70%-84%）
- **特征**：均线有一定差距，趋势中等，价格位置一般
- **建议**：可以关注，但需要结合其他指标
- **示例**：MA8=11.0, MA20=10.5，差距5%，趋势强度0.5

### 低置信度（60%-69%）
- **特征**：均线差距小，趋势不明确，价格位置不佳
- **建议**：谨慎操作，信号可靠性较低
- **示例**：MA8=10.2, MA20=10.0，差距2%，趋势强度0.2

## 🎯 实际应用示例

### 示例1：短线买入信号
```
股票：000001
MA34：10.50
MA55：10.00
当前价格：10.80

计算过程：
maGap = |10.50 - 10.00| / 10.00 * 100 = 5%
priceAboveMA = (10.80 - 10.50) / 10.50 * 100 = 2.86%
confidence = 70 + 5 * 2 + 2.86 * 0.5 = 81.43%

结果：买入信号，置信度81%
```

### 示例2：中线卖出信号
```
股票：600036
MA8：15.20
MA20：16.00
当前价格：15.00
趋势强度：0.6

计算过程：
maGap = |15.20 - 16.00| / 16.00 * 100 = 5%
priceBelowMA = (15.20 - 15.00) / 15.20 * 100 = 1.32%
confidence = 70 + 5 * 1.5 + 0.6 * 10 + 1.32 * 0.3 = 84.9%

结果：卖出信号，置信度85%
```

## ⚠️ 注意事项

1. **置信度不是准确率**：置信度表示信号强度，不是历史准确率
2. **结合基本面**：技术分析需要结合基本面分析
3. **市场环境**：考虑整体市场环境对信号的影响
4. **风险控制**：高置信度不代表无风险
5. **及时调整**：根据市场变化及时调整策略

## 🔧 优化建议

1. **多指标验证**：结合多个技术指标提高准确性
2. **历史回测**：通过历史数据验证置信度有效性
3. **动态调整**：根据市场环境动态调整置信度计算参数
4. **机器学习**：使用机器学习算法优化置信度计算
5. **实时更新**：根据实时市场数据更新置信度

现在置信度计算更加科学和合理了！系统会根据均线差距、趋势强度、价格位置等多个因素动态计算置信度，而不是使用固定的硬编码值。
